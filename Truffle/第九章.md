ç›®å‰æˆ‘å€‘ä¸éæ˜¯å®Œæˆäº†æš–èº«æ´»å‹•...

ä½†ç¾åœ¨æ˜¯æ™‚å€™å±•ç¾ä¸€ä¸‹ä½ æœƒç”šéº¼äº†ï¼

åœ¨ä¸‹ä¸€ç« ç¯€ï¼Œæˆ‘å€‘å°‡æœƒæŠŠæˆ‘å€‘å­¸æœƒçš„éƒ½æ”¾åœ¨ä¸€èµ·ä¸¦testä¸€äº›å¾ˆé…·çš„æ±è¥¿ã€‚

é¦–å…ˆå‘¢ï¼Œæˆ‘å€‘testçœ‹çœ‹Alice transfer ERC721 Tokençµ¦Bobçš„æƒ…å½¢ï¼Œåªæœ‰ä¸€æ­¥é©Ÿçš„é‚£ç¨®ã€‚

é€™æ˜¯æˆ‘å€‘testè©²åšçš„äº‹æƒ…ï¼š

+ å‰µå»ºä¸€å€‹æ–°ç–†å±çµ¦Alice(è¦è¨˜å¾—é€™å€‹æ®­å±åªä¸éæ˜¯å€‹ERC721 Token)
+ è®“Alice transfer å¥¹çš„ ERC721 token çµ¦Bobã€‚
+ é€™æ™‚å€™ï¼ŒBobæ‡‰è©²è¦æ“æœ‰è©²ERC721 tokenäº†ã€‚é€™æ¨£ï¼ŒownerOf å‡½å¼returnçš„å€¼æ‡‰è©²æœƒæ˜¯Bobçš„åœ°å€ã€‚
+ åœ¨assertå‡½å¼ä¸­ï¼Œç”¨newOwnerå‡½å¼æª¢æŸ¥çœ‹çœ‹Bobæ˜¯ä¸æ˜¯æ–°çš„æ“æœ‰è€…(é€™è£¡æˆ‘ç¿»è­¯ä¸å¤ªå¥½...è‹±æ–‡ç©äº†å€‹å°é›™é—œ)

## Put it to the test
1. å‡½å¼çš„ç¬¬ä¸€è¡Œè¦å‘¼å« createRandomZombieã€‚å¸¶å…¥ zombieNames[0] ä½œç‚ºåƒæ•¸è€ŒAliceæ˜¯å…¶ owner ã€‚
2. ç¬¬äºŒè¡Œå®£å‘Šä¸€å€‹åç¨±ç‚º zombieId çš„ const ä¸¦è¨­å®šå…¶ç­‰æ–¼æ®­å±çš„idã€‚åœ¨Chapter 4ï¼Œä½ æœƒå­¸åˆ°å¦‚ä½•å–å›(retrieve)è©²è³‡è¨Šã€‚å¦‚æœéœ€è¦çš„è©±ï¼Œå»è¤‡ç¿’ä¸€ä¸‹ã€‚
3. ç„¶å¾Œï¼Œæˆ‘å€‘å‘¼å« transferFrom å‡½å¼ä¸¦å¸¶å…¥aliceå’Œbobä½œç‚ºç¬¬ä¸€å€‹åƒæ•¸ã€‚è¦ç¢ºå®šæ˜¯Aliceå‘¼å«é€™å€‹å‡½å¼è€Œä¸”æˆ‘å€‘è¦awaitå®ƒè·‘å®Œä¹‹å¾Œå†åˆ°ä¸‹ä¸€æ­¥å»ã€‚
4. å®£å‘Šä¸€å€‹å¸¸æ•¸ç‚º newOwner ã€‚å…¶å€¼ç‚º ownerOfå¸¶å…¥zombieIdã€‚
5. æœ€å¾Œï¼Œä¾†æª¢æŸ¥Bobæ˜¯ä¸æ˜¯æ“æœ‰é€™å€‹ERC721 tokenã€‚å°‡é€™å€‹æª¢æŸ¥æ”¾é€²codeä¸­ï¼Œä»£è¡¨æˆ‘å€‘è¦åŸ·è¡Œ assert.equal å‡½å¼ä¸¦å¸¶å…¥ newOwner å’Œ bob ä½œç‚ºåƒæ•¸ã€‚

> Noteï¼š assert.equal(newOner, bob) å’Œ assert.equal(bob, newOwner)åŸºæœ¬ä¸Šæ˜¯ç›¸åŒçš„ã€‚ä½†æˆ‘å€‘çš„çµ‚ç«¯æ©Ÿç¿»è­¯å™¨æ²’é€™éº¼å²å®³ï¼Œæ‰€ä»¥é™¤éä½ ç”¨ç¬¬ä¸€ç¨®ï¼Œä¸ç„¶ä»–æœƒä»¥ç‚ºä½ æ˜¯éŒ¯çš„ã€‚

6. æˆ‘å‰›å‰›æœ‰èªªå‰ä¸€æ­¥å°±æ˜¯æœ€å¾Œäº†ï¼Well...é€™æ˜¯å€‹è¬Šè©±ã€‚æˆ‘å€‘è¦åšçš„æœ€å¾Œä¸€ä»¶äº‹æ˜¯ç§»é™¤ x ä¾†"unskip"ç¬¬ä¸€å€‹scenarioã€‚

å‘¼ï¼å¥½å¤šçš„codeã€‚å¸Œæœ›ä½ èƒ½æŠŠå®ƒæå®šã€‚æ²’æœ‰çš„è©±ï¼Œæ”¾å¿ƒä½¿ç”¨"show answer"æŒ‰éˆ•ã€‚

ç¾åœ¨ä¾†åŸ·è¡Œ truffle test ä¾†çœ‹çœ‹æˆ‘å€‘æ–°çš„testèƒ½ä¸èƒ½é€šéï¼š

```
Contract: CryptoZombies
  âœ“ should be able to create a new zombie (146ms)
  âœ“ should not allow two zombies (235ms)
  with the single-step transfer scenario
    âœ“ should transfer a zombie (382ms)
  with the two-step transfer scenario
    - should approve and then transfer a zombie when the owner calls transferFrom
    - should approve and then transfer a zombie when the approved address calls transferFrom


3 passing (1s)
2 pending
```
å°±é€™æ¨£äº†ï¼æˆ‘å€‘çš„codeå‚‘å‡ºçš„é€šéäº†testã€‚ğŸ‘ğŸ»

åœ¨ä¸‹ä¸€ç« ç¯€ï¼Œæˆ‘å€‘è¦ä¾†åˆ° approve å‡½å¼å¾Œæ¥è‘— transferFrom å‡½å¼çš„å…©æ­¥é©Ÿscenarioã€‚

### å–®å­—&è¨»è§£
é€™ä¸€ç« ç¯€è‘—å¯¦å¤ é›£...æ˜¯è­¯è€…ç¬¬ä¸€å€‹å¡é—œçš„ç« ç¯€ï¼Œå¦‚æœæˆ‘æœ‰æ™‚é–“çš„è©±æœƒå›é ­è©¦è‘—ä¾†èªªæ˜ä¸€ä¸‹é€™ä¸€ç« ç¯€ã€‚
merely  åƒ…åƒ…ã€åªä¸é
to begin withï¼šé¦–å…ˆ
be nothing more of åƒ…åƒ…
interpreter å£è­¯å“¡ï¼Œ(é›»è…¦ç¨‹å¼)ç›´è­¯å™¨
with flying colorï¼šå‡ºè‰²çš„ï¼Œæˆç¸¾å„ªç•°åœ°

Put it to the testçš„å°æç¤ºï¼š
1. è¦è¨˜å¾—å‰é¢è¦awaitå®ƒç”Ÿæˆä¸€å€‹newåˆç´„å¯¦ä¾‹ï¼Œæœ€å¾Œé¢è¨˜å¾—åŠ {from: alice}
2. æ˜¯result.logs[0]çš„èªæ³•ï¼Œå…¶å¯¦æ‡‰è©²æ˜¯ç¬¬äº”ç« ï¼Œé€™è£¡æ‡‰è©²æ˜¯å¯«éŒ¯äº†ã€‚å¦å¤–æœ€å¾Œè¦åŠ ä¸€å€‹toNumber()ä¾†è®“zombieIdæˆç‚ºä¸€å€‹ç·¨è™Ÿã€‚
3. é€™è£¡å¾ˆæ€ªã€‚æˆ‘å€‘è¦åšone step transferï¼Œæ‡‰è©²è¦ç”¨transferå‡½å¼è€Œä¸æ‡‰è©²æ˜¯transferFromï¼Œå¦å¤–è§£ç­”ä¸­å®ƒåœ¨æœ€å¾Œæ”¾å…¥{from: alice}åƒæ•¸ä¹Ÿä¸æ˜¯ä¹‹å‰æ•™éçš„èªæ³•ã€‚
4. ownerOfæ˜¯contractInstanceä¸­çš„ä¸€å€‹å‡½å¼ï¼Œé‚£åªè¦æ˜¯ç”¨åˆ°contractInstanceçš„ç•¶ç„¶éƒ½è¦awaitå›‰ã€‚

