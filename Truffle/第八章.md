å•é¡Œä¾†äº†ï¼å¦‚æœAliceæƒ³è¦æŠŠå®ƒçš„æ®­å±é€çµ¦Bobã€‚æˆ‘å€‘è¦åšé€™å€‹testå—ï¼Ÿ

ç•¶ç„¶ï¼

å¦‚æœä½ æœ‰è·Ÿè‘—å‰é¢çš„èª²ç¨‹ï¼Œä½ æ‡‰è©²çŸ¥é“ï¼Œä¸èªªåˆ¥çš„(è¨»)ï¼Œæˆ‘å€‘çš„æ®­å±å€‘æ˜¯ç¹¼æ‰¿è‡ª ERC721ã€‚è€ŒERC721è¦ç¯„äº†å…©ç¨®æ–¹å¼ä¾†äº¤æ›tokensï¼š

(1)
```javascript
function transfer(address _from, address _to, uint256 tokenId) external payable;
```
ç¬¬ä¸€å€‹æ–¹å¼æ˜¯Alice(æ“æœ‰è€…)å‘¼å« transferFrom å¸¶å…¥å¥¹çš„ address ä½œç‚º _fromåƒæ•¸ï¼ŒBobçš„ address ä½œç‚º _to åƒæ•¸ï¼Œé‚„æœ‰å¥¹æƒ³è¦transferçš„ zombieIdã€‚

(2)
```javascript
function approve(address _approved, uint256 _tokenId) external payable;
```
æ¥è‘—å¦ä¸€å€‹function
```javascript
function transferFrom(address _from, address _to, uint256 tokenId) external payable;
```
ç¬¬äºŒç¨®æ–¹å¼æ˜¯Aliceå…ˆå‘¼å« approveå¸¶å…¥Bobçš„addresså’Œ zombieIdã€‚åˆç´„æœƒè¨˜éŒ„Bobè¢«åŒæ„å¯ä»¥æ‹¿å–æ®­å±ã€‚æ¥è‘—ï¼Œç•¶Aliceæˆ–Bobå‘¼å« transferFrom æ™‚ï¼Œåˆç´„æœƒæª¢æŸ¥ msg.sender æ˜¯ä¸æ˜¯Aliceæˆ–Bobçš„addressã€‚æ˜¯çš„è©±ï¼Œå®ƒæœƒtransferæ®­å±çµ¦Bobã€‚

æˆ‘å€‘ä¾†å°‡é€™å…©ç¨®transferæ®­å±çš„æ–¹å¼å«åš"scenarios"ç‚ºäº†è¦æ¸¬è©¦å„å€‹scenarioï¼Œæˆ‘å€‘æœƒè¦å‰µå»ºå…©çµ„testä¸¦çµ¦ä»–å€‘æœ‰æ„ç¾©çš„æè¿°ã€‚

ç‚ºç”šéº¼è¦testè®Šæˆçµ„åˆçš„ï¼Ÿæˆ‘å€‘åªæœ‰å¹¾å€‹testsè€Œå·²...

æ˜¯çš„ï¼Œç¾åœ¨æˆ‘å€‘çš„é‚è¼¯æ˜¯å¾ˆç›´æ¥çš„ï¼Œä½†å®ƒå¯èƒ½ä¸æœƒä¸€ç›´éƒ½é€™æ¨£ã€‚å„˜ç®¡ï¼Œç¬¬äºŒç¨®scenario(approveå¾Œé¢æ¥è‘—transferFromé‚£ç¨®)éœ€è¦è‡³å°‘å…©å€‹testï¼š
+ é¦–å…ˆï¼Œæˆ‘å€‘è¦å…ˆæª¢æŸ¥Aliceè‡ªå·±èƒ½ä¸èƒ½transferé€™å€‹æ®­å±ã€‚
+ ç„¶å¾Œï¼Œæˆ‘å€‘ä¹Ÿè¦æª¢æŸ¥Bobæœ‰æ²’æœ‰è¢«å‡†è¨±åŸ·è¡Œ transferFrom

ä¸åªå¦‚æ­¤ï¼Œåœ¨å°‡ä¾†ï¼Œä½ å¯èƒ½æœƒå¢åŠ å…¶ä»–éœ€è¦ä¸åŒtestçš„åŠŸèƒ½ã€‚æˆ‘å€‘ç›¸ä¿¡åœ¨é–‹å§‹æ™‚ç”¨ä¸€å€‹å¯æ“´å±•çš„çµæ§‹æ˜¯æœ€å¥½çš„ğŸ˜‰ã€‚é€™è®“å…¶ä»–äººæ›´å®¹æ˜“çœ‹æ‡‚ä½ çš„codeï¼Œæˆ–æ˜¯å¦‚æœä½ å»å¿™ä¸€ä¸‹å…¶ä»–äº‹æƒ…ä¹‹å¾Œå›ä¾†é‚„èƒ½çœ‹æ‡‚ã€‚

> Noteï¼šå¦‚æœä½ å’Œå…¶ä»–codersä¸€èµ·å·¥ä½œæ™‚åœåœ¨æŸå€‹åœ°æ–¹ï¼Œæœƒç™¼ç¾ä»–å€‘æ›´å‚¾å‘followä½ ä¸€é–‹å§‹å¯«codeçš„è¦ç¯„ã€‚èƒ½å¤ æœ‰æ•ˆç‡çš„åˆä½œæœƒæ˜¯ä½ å°‡ä¾†æƒ³åœ¨å¤§å‹ã€æˆåŠŸçš„å°ˆæ¡ˆä¸­çš„æ ¸å¿ƒæŠ€èƒ½ã€‚è¶Šæ—©é¤Šæˆå¥½çš„ç¿’æ…£æœƒå¹«åŠ©ä½ çš„codingç”Ÿæ´»æ›´è¼•é¬†ä¹Ÿæ›´æˆåŠŸã€‚

## The context function
å°æ–¼ä¸€çµ„æ¸¬è©¦(åŸæ–‡ç”¨group tests)ï¼Œ Truffle æä¾›äº†ä¸€å€‹ context å‡½å¼ã€‚è®“æˆ‘å¿«é€Ÿåœ°å‘Šè¨´ä½ å¦‚ä½•ä½¿ç”¨å®ƒä¾†è®“æˆ‘å€‘æ›´å¥½çš„çµ„å»ºcodeï¼š

```javascript
context("with the single-step transfer scenario", async () => {
    it("should transfer a zombie", async () => {
      // TODO: Test the single-step transfer scenario.
    })
})

context("with the two-step transfer scenario", async () => {
    it("should approve and then transfer a zombie when the approved address calls transferFrom", async () => {
      // TODO: Test the two-step scenario.  The approved address calls transferFrom
    })
    it("should approve and then transfer a zombie when the owner calls transferFrom", async () => {
        // TODO: Test the two-step scenario.  The owner calls transferFrom
     })
})
```

å¦‚æœæˆ‘å€‘å°‡å®ƒæ”¾å…¥æˆ‘å€‘çš„ CryptoZombies.js æª”æ¡ˆä¸¦åŸ·è¡Œ truffle test å®ƒçš„outputæœƒé•·å¾—åƒæ˜¯é€™æ¨£ï¼š

```
Contract: CryptoZombies
    âœ“ should be able to create a new zombie (100ms)
    âœ“ should not allow two zombies (251ms)
    with the single-step transfer scenario
      âœ“ should transfer a zombie
    with the two-step transfer scenario
      âœ“ should approve and then transfer a zombie when the owner calls transferFrom
      âœ“ should approve and then transfer a zombie when the approved address calls transferFrom


  5 passing (2s)
```

Well?

Hmm...

å†çœ‹ä¸€æ¬¡ï¼ï¼ä¸Šé¢çš„outputæœ‰é»å•é¡Œã€‚å®ƒçœ‹èµ·ä¾†åƒæ˜¯æ‰€æœ‰testséƒ½é€šéäº†ä½†å®ƒå¾ˆæ˜é¡¯ä¸å°ï¼Œå› ç‚ºæˆ‘å€‘æ ¹æœ¬é‚„æ²’å¯«ä»»ä½•æ±è¥¿é€²å»ï¼

å¹¸é‹åœ°ï¼Œæœ‰å€‹ç°¡å–®çš„æ–¹æ³•ï¼ï¼å¦‚æœæˆ‘å€‘æ”¾ä¸€å€‹ x åœ¨ context() å‡½å¼ä¹‹å‰å°±åƒï¼š xcontext()ã€‚ Truffleã€‚ Truffleæœƒè‡ªå‹•è·³éé€™äº›testsã€‚

> Noteï¼š x ä¹Ÿå¯ä»¥è¢«æ”¾åœ¨ä¸€å€‹ it() å‡½å¼ä¹‹å‰ã€‚ç•¶testä¸­çš„éŸ“æ˜¯å®Œæˆäº†åˆ¥å¿˜è¨˜è¦å°‡æ‰€æœ‰ x éƒ½ç§»é™¤æ‰ï¼

ç¾åœ¨ï¼Œä¾†é‹è¡Œ truffle testã€‚ Outputæ‡‰è©²é•·å¾—åƒé€™æ¨£ï¼š

```
Contract: CryptoZombies
    âœ“ should be able to create a new zombie (199ms)
    âœ“ should not allow two zombies (175ms)
    with the single-step transfer scenario
      - should transfer a zombie
    with the two-step transfer scenario
      - should approve and then transfer a zombie when the owner calls transferFrom
      - should approve and then transfer a zombie when the approved address calls transferFrom


  2 passing (827ms)
  3 pending
```

æœ‰ "-" çš„åœ°æ–¹ä»£è¡¨testå› ç‚ºé‚£å€‹ "x" è¨˜è™Ÿè€Œè¢«è·³éäº†ã€‚

å¾ˆç°¡æ½”é½ï¼Ÿç¾åœ¨ä½ å¯ä»¥éš¨æ™‚å»åŸ·è¡Œtestï¼Œç„¶å¾Œæ¨™è¨˜å‡ºä½ ä¹‹å¾Œæ‰æœƒç·¨å¯«çš„ç©ºç™½å‡½å¼ã€‚

## Put it to the test

1. å°‡ä¸Šé¢çš„codeè¤‡è£½è²¼ä¸Šã€‚
2. æš«æ™‚ï¼Œå°‡æˆ‘å€‘æ–°çš„ context å‡½å¼éƒ½*è·³é*ã€‚

æˆ‘å€‘çš„testæš«æ™‚æ˜¯ç©ºçš„æ¶æ§‹ï¼Œè¦é‹è¡Œä»–å€‘é‚„æœ‰å¾ˆå¤šçš„logicè¦å¯«ã€‚æˆ‘å€‘æœƒåˆ†å¥½å¹¾å€‹å°éƒ¨åˆ†åœ¨å¾Œé¢å¹¾ç« ç¯€å®Œæˆã€‚

---
among/amongstï¼šæ„æ€å…¶å¯¦ç›¸åŒï¼Œä½†æ˜¯amongstæ›´formalï¼Œå…¶å¯¦ä¸å¤ªå¸¸ç”¨ã€‚
among other thingsï¼šåˆ¥çš„æ±è¥¿å…ˆä¸èªªï¼›å…ˆä¸èªªåˆ¥çš„ã€‚(é€™å€‹ä¸å¤ªå¥½ç¿»è­¯...)
scenarioï¼šåŠ‡æœ¬æ¦‚è¦ï¼›å¯èƒ½ç™¼ç”Ÿçš„äº‹æ…‹ï¼›å ´æ™¯
scaleableï¼šåŒscalableï¼Œå¯æ“´å±•çš„
go alongï¼šåœ¨(æ´»å‹•é€²è¡Œéç¨‹)ä¸­ã€(æœªç¶“è¦åŠƒçš„)å»

